plugins {
    id 'com.palantir.docker' version '0.25.0'
}
group 'it.csttech.docker'
version '1.0-SNAPSHOT'

//processResources {
//    from 'src/main/resources'
//    into "${buildDir}/docker"
//}


['8.5', '9'].each { tomcatMajor ->
    ['jdk8-slim', 'jdk11-slim', 'jdk14'].each { javaVersion ->
        def tomcatVersion = "$tomcatMajor-$javaVersion"
        docker {
            def tagName = "csttech/${project.name}:${tomcatVersion}"
            dependsOn dockerClean
            dockerfile file('src/main/docker/Dockerfile')
            name "csttech/${project.name}"
            files 'src/main/resources'
            tag "dockerHub-${tomcatVersion}", tagName
            tag "docker01-${tomcatVersion}", "docker01.csttech.it:5443/${tagName}"
            buildArgs 'TOMCAT_VERSION': tomcatVersion
        }
    }
}




